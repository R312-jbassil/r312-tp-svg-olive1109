---
import Layout from '../layouts/Layout.astro';
import PocketBase from 'pocketbase';

const pb = new PocketBase('http://127.0.0.1:8090');
let svgList = [];
try {
  svgList = await pb.collection('svg').getFullList();
} catch (e) {
  svgList = [];
}
---

<Layout>
    <nav class="navbar bg-base-100 px-8 py-4 shadow mb-4 rounded-b-xl">
        <div class="flex-1">
            <a href="/" class="btn btn-ghost text-xl">Home</a>
            <a href="/generator" class="btn btn-ghost text-xl">Generator</a>
            <a href="/library" class="btn btn-ghost text-xl">Library</a>
        </div>
    </nav>
    <main class="flex flex-col items-center justify-center min-h-[80vh] w-full">
        <h1 class="text-4xl font-bold mb-4">Library</h1>
        <p class="mb-6 text-lg">Your saved SVGs will appear here.</p>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8 w-full max-w-6xl">
            {svgList.map(svg => (
                <a href={`/svg/${svg.id}`} class="card bg-base-100 shadow-xl p-6 flex flex-col items-center hover:scale-105 transition-transform">
                    <div class="w-full flex justify-center items-center min-h-[150px] mb-4">
                        <div innerHTML={svg.code}></div>
                    </div>
                    <div class="font-semibold text-lg text-center">{svg.name}</div>
                </a>
            ))}
        </div>
        {svgList.length === 0 && (
            <div class="text-red-500 text-xl mt-8">Aucun SVG enregistr√©</div>
        )}
    </main>
</Layout>